About the technique
- `fit_curvature_min`: computes curvature via the second derivative of a smoothed spline over the sequence and returns the minimum curvature position for increasing curves; useful to find a trade-off point where additional gains become marginal.

```{r}
# installation 
#install.packages("daltoolbox")

# loading DAL
library(daltoolbox) 

# for ploting
library(ggplot2)
library(dplyr)
```

Load example data (PCA on wine dataset) and build cumulative variance curve.
```{r}
wine <- get(load(url("https://raw.githubusercontent.com/cefet-rj-dal/daltoolbox/main/develop/wine.RData")))
head(wine)
```

# Example: PCA components
PCA cumulative variance: early dimensions concentrate high variance; adding too many dimensions brings marginal gains.
The goal is to establish a trade-off point.

```{r}
pca_res = prcomp(wine[,2:ncol(wine)], center=TRUE, scale.=TRUE)
y <- cumsum(pca_res$sdev^2/sum(pca_res$sdev^2)) # cumulative variance
x <- 1:length(y)
```

```{r}
dat <- data.frame(x, value = y, variable = "PCA")
dat$variable <- as.factor(dat$variable)
head(dat)
```

```{r}
grf <- plot_scatter(dat, label_x = "dimensions", label_y = "cumulative variance", colors="black") + 
    theme(text = element_text(size=16))
plot(grf)
```

# Minimum curvature
If the curve is increasing, use minimum curvature analysis.
It brings a trade-off between having lower x values (with not-so-high y values) and higher x values (without too much increase in y values).

```{r}
myfit <- fit_curvature_min()
res <- transform(myfit, y)  # returns optimal index (knee)
head(res)
```

```{r}
plot(grf + geom_vline(xintercept = res$x, linetype="dashed", color = "red", size=0.5))
```

References
- Satopaa, V., Albrecht, J., Irwin, D., Raghavan, B. (2011). Finding a "Kneedle" in a Haystack: Detecting Knee Points in System Behavior.
